######
# In this script I have the proxy response with up to 300 lines of orderbook
# I need to create the async loop that will receive this data every few miliseconds
#####


import json

# exchange_spec_dict = json.load(open("../admin/exchanges"))
#
# print(exchange_spec_dict)


#
#
# data = json.load(open('../admin/exchanges'))
#
# print(data['currency_mapping']['symbols']['btcpln'])
#
# print(data['source']['rest_url'])

#
# class Periodic:
#     def __init__(self, func, time):
#         self.func = func
#         self.time = time
#         self.is_started = False
#         self._task = None
#
#     async def start(self):
#         if not self.is_started:
#             self.is_started = True
#             # Start task to call func periodically:
#             self._task = asyncio.ensure_future(self._run())
#
#     async def stop(self):
#         if self.is_started:
#             self.is_started = False
#             # Stop task and await it stopped:
#             self._task.cancel()
#             with suppress(asyncio.CancelledError):
#                 await self._task
#
#     async def _run(self):
#         while True:
#             await asyncio.sleep(self.time)
#             self.func()
#
# async def main():
#     p = Periodic(lambda: print('test'), 1)
#     try:
#         print('Start')
#         await p.start()
#         await asyncio.sleep(3.1)
#
#         print('Stop')
#         await p.stop()
#         await asyncio.sleep(3.1)
#
#     finally:
#         await p.stop()  # we should stop task finally
#
#
# if __name__ == '__main__':
#     loop = asyncio.get_event_loop()
#     loop.run_until_complete(main())

# a = ['asdasd', 'afbdfgbnfg']
#
# print(a['afbdfgbnfg'])


bitkub_url = [{
    'error': 0, 'result': [
        [99545967, 1642788419, 35581.36, 1294200.07, 0.02749294],
        [99545968, 1642788419, 117523.49, 1294200.07, 0.09080783],
        [99545970, 1642788420, 2269059.93, 1294200.07, 1.75325283],
        [99545973, 1642788420, 873774, 1294200.07, 0.675146],
        [99545960, 1642788417, 123025.42, 1294200.06, 0.09505905]]},
    {'error': 0, 'result': [
        [94054796, 1642813617, 104595.57, 1299074.7, 0.08051544],
        [94054789, 1642813612, 120406.61, 1299074.75, 0.09268644],
        [94054785, 1642788414, 54691.05, 1299074.86, 0.0421],
        [94054793, 1642788417, 635651.6, 1299824.9, 0.48902864],
        [94054612, 1642788336, 6461429.72, 1299824.93, 4.971]]},

    {'error': 0, 'result': [
        [92522256, 1642788418, 203.67, 94034.73, 0.00216591],
        [92522262, 1642788419, 3696.17, 94034.69, 0.0393065],
        [92522235, 1642788410, 564.97, 94034.68, 0.00600815],
        [92522125, 1642788364, 18.79, 93980, 0.0002],
        [92522000, 1642813303, 46939.71, 93950, 0.49962448]]},
    {'error': 0, 'result': [
        [86546274, 1642813603, 31391.56, 94150, 0.33342081],
        [86546272, 1642788419, 8261.11, 94197.46, 0.0877],
        [86546263, 1642788418, 98387.43, 94197.47, 1.04448067],
        [86546257, 1642788415, 14.13, 94197.53, 0.00015004],
        [86546268, 1642788419, 7014907.02, 94317.19, 74.3757]]},

    {'error': 0, 'result': [
        [67300442, 1642813561, 0, 5.1051, 0.00078883],
        [67300100, 1642813405, 0, 5.105, 0.00125533],
        [67300168, 1642788258, 0, 5.105, 0.00080471],
        [67300475, 1642788416, 0.86, 5.1003, 0.168787],
        [67300452, 1642788404, 8.71, 5.1002, 1.70937568]]},
    {'error': 0, 'result': [
        [61056817, 1642813132, 11464.36, 5.11, 2243.51658354],
        [61056849, 1642788420, 19183.15, 5.1179, 3748.2481729],
        [61056831, 1642788407, 5947.62, 5.118, 1162.1],
        [61056843, 1642788417, 113365.58, 5.1195, 22143.87875875],
        [61054058, 1642786636, 638.4, 5.12, 124.6875]]},

    {'error': 0, 'result': [
        [49849577, 1642788420, 7.57, 82.64, 0.091662],
        [49849558, 1642788414, 0.55, 82.6, 0.00669722],
        [49849564, 1642788417, 125.42, 82.59, 1.51868639],
        [49849575, 1642788420, 1.38, 82.49, 0.01684751],
        [49849576, 1642788420, 10.19, 82.49, 0.12362486]]},
    {'error': 0, 'result': [
        [41473295, 1642788420, 102615.69, 82.94, 1237.22801065],
        [41473284, 1642788416, 42926.48, 82.95, 517.49828349],
        [41473290, 1642788418, 7465.5, 82.95, 90],
        [41473291, 1642788419, 6725.6, 82.95, 81.08018023],
        [41468155, 1642786166, 25232.51, 83, 304.00616489]]}]

# print(bitkub_url[0]['result'][0])
# print(bitkub_url[0]['result'][1])
#
# print(bitkub_url[1]['result'][0])
# print(bitkub_url[1]['result'][1])

zonda_url = {'status': 'Ok',
             'sell': [
                 {'ra': '154875.84', 'ca': '0.80122914', 'sa': '0.80122914', 'pa': '0.80122914', 'co': 2},
                 {'ra': '154875.85', 'ca': '0.27010429', 'sa': '0.27010429', 'pa': '0.27010429', 'co': 2},
                 {'ra': '154882.63', 'ca': '0.00006', 'sa': '0.00006', 'pa': '0.00006', 'co': 1},
                 {'ra': '155070.73', 'ca': '0.09199065', 'sa': '0.09199065', 'pa': '0.09199065', 'co': 1},
                 {'ra': '155082.58', 'ca': '0.3', 'sa': '0.3', 'pa': '0.3', 'co': 1},
                 {'ra': '155484.65', 'ca': '1.0227', 'sa': '1.0227', 'pa': '1.0227', 'co': 1},
                 {'ra': '155484.66', 'ca': '7.5134', 'sa': '7.5134', 'pa': '7.5134', 'co': 1},
                 {'ra': '156257.88', 'ca': '0.3000', 'sa': '0.3000', 'pa': '0.3000', 'co': 1},
                 {'ra': '156257.89', 'ca': '3.8156', 'sa': '3.8156', 'pa': '3.8156', 'co': 1},
                 {'ra': '156896.42', 'ca': '0.0063973', 'sa': '0.305511', 'pa': '0.0063973', 'co': 1}],
             'buy': [{'ra': '153200', 'ca': '0.76472748', 'sa': '0.76472748', 'pa': '0.76472748', 'co': 2},
                     {'ra': '153200.11', 'ca': '0.02218398', 'sa': '0.0261097', 'pa': '0.02218398', 'co': 1},
                     {'ra': '153210', 'ca': '0.00231552', 'sa': '0.00231552', 'pa': '0.00231552', 'co': 2},
                     {'ra': '153210.01', 'ca': '0.03544726', 'sa': '0.03544726', 'pa': '0.03544726', 'co': 1},
                     {'ra': '154000', 'ca': '0.00194805', 'sa': '0.00194805', 'pa': '0.00194805', 'co': 1},
                     {'ra': '154000.36', 'ca': '0.03246746', 'sa': '0.03246746', 'pa': '0.03246746', 'co': 1},
                     {'ra': '154005.87', 'ca': '0.00064939', 'sa': '0.00064939', 'pa': '0.00064939', 'co': 1},
                     {'ra': '154005.88', 'ca': '0.01722083', 'sa': '0.01722083', 'pa': '0.01722083', 'co': 1},
                     {'ra': '154005.89', 'ca': '0.2481', 'sa': '0.2481', 'pa': '0.2481', 'co': 1},
                     {'ra': '154200', 'ca': '0.00648508', 'sa': '0.00648508', 'pa': '0.00648508', 'co': 1}],
             'timestamp': '1642790397719', 'seqNo': '91848334'}

zonda_2 = [{'status': 'Ok', 'sell': [{'ra': '154549.99', 'ca': '0.7582', 'sa': '0.7582', 'pa': '0.7582', 'co': 1},
                                     {'ra': '154550', 'ca': '0.00647217', 'sa': '0.0200', 'pa': '0.00647217', 'co': 1},
                                     {'ra': '154692.09', 'ca': '0.01224429', 'sa': '0.01224429', 'pa': '0.01224429',
                                      'co': 1},
                                     {'ra': '154692.10', 'ca': '0.00006000', 'sa': '0.00006000', 'pa': '0.00006000',
                                      'co': 1},
                                     {'ra': '154895', 'ca': '0.00039381', 'sa': '0.00039381', 'pa': '0.00039381',
                                      'co': 1}, {'ra': '154931.78', 'ca': '0.3', 'sa': '0.3', 'pa': '0.3', 'co': 1},
                                     {'ra': '155484.25', 'ca': '1.24063', 'sa': '1.24063', 'pa': '1.24063', 'co': 2},
                                     {'ra': '155484.26', 'ca': '0.04166259', 'sa': '0.04166259', 'pa': '0.04166259',
                                      'co': 1},
                                     {'ra': '155484.43', 'ca': '0.0840385', 'sa': '0.0840385', 'pa': '0.0840385',
                                      'co': 1},
                                     {'ra': '155484.66', 'ca': '7.5134', 'sa': '7.5134', 'pa': '7.5134', 'co': 1}],
            'buy': [{'ra': '153310.01', 'ca': '0.03229755', 'sa': '0.03229755', 'pa': '0.03229755', 'co': 1},
                    {'ra': '153310.07', 'ca': '0.7582', 'sa': '0.7582', 'pa': '0.7582', 'co': 1},
                    {'ra': '153310.08', 'ca': '0.01729899', 'sa': '0.01729899', 'pa': '0.01729899', 'co': 1},
                    {'ra': '154000', 'ca': '0.00629480', 'sa': '0.00629480', 'pa': '0.00629480', 'co': 3},
                    {'ra': '154000.36', 'ca': '0.02041081', 'sa': '0.03246746', 'pa': '0.02041081', 'co': 1},
                    {'ra': '154000.41', 'ca': '0.00308460', 'sa': '0.00308460', 'pa': '0.00308460', 'co': 1},
                    {'ra': '154003', 'ca': '0.00468841', 'sa': '0.00468841', 'pa': '0.00468841', 'co': 2},
                    {'ra': '154050', 'ca': '0.14200376', 'sa': '0.14200376', 'pa': '0.14200376', 'co': 1},
                    {'ra': '154050.07', 'ca': '0.76598928', 'sa': '0.76598928', 'pa': '0.76598928', 'co': 2},
                    {'ra': '154050.08', 'ca': '0.00006', 'sa': '0.00006', 'pa': '0.00006', 'co': 1}],
            'timestamp': '1642792869817', 'seqNo': '91852935'}, {'status': 'Ok', 'sell': [
    {'ra': '11194.89', 'ca': '0.47', 'sa': '0.47', 'pa': '0.47', 'co': 1},
    {'ra': '11195.08', 'ca': '0.21379898', 'sa': '0.21379898', 'pa': '0.21379898', 'co': 1},
    {'ra': '11198.82', 'ca': '0.0008', 'sa': '0.0008', 'pa': '0.0008', 'co': 1},
    {'ra': '11198.88', 'ca': '19.365536', 'sa': '19.365536', 'pa': '19.365536', 'co': 1},
    {'ra': '11198.89', 'ca': '0.26063037', 'sa': '0.3000', 'pa': '0.26063037', 'co': 2},
    {'ra': '11200', 'ca': '1.01651142', 'sa': '1.07200695', 'pa': '1.01651142', 'co': 2},
    {'ra': '11233.45', 'ca': '13.27658', 'sa': '13.27658', 'pa': '13.27658', 'co': 1},
    {'ra': '11233.46', 'ca': '0.52766964', 'sa': '0.52766964', 'pa': '0.52766964', 'co': 2},
    {'ra': '11233.48', 'ca': '8.65684995', 'sa': '8.65684995', 'pa': '8.65684995', 'co': 1},
    {'ra': '11233.52', 'ca': '0.95200004', 'sa': '0.95200004', 'pa': '0.95200004', 'co': 1}], 'buy': [
    {'ra': '11100.1', 'ca': '0.00450446', 'sa': '0.00450446', 'pa': '0.00450446', 'co': 1},
    {'ra': '11110', 'ca': '0.01800180', 'sa': '0.01800180', 'pa': '0.01800180', 'co': 1},
    {'ra': '11111.5', 'ca': '0.06299779', 'sa': '0.06299779', 'pa': '0.06299779', 'co': 1},
    {'ra': '11115', 'ca': '0.00197931', 'sa': '0.00197931', 'pa': '0.00197931', 'co': 1},
    {'ra': '11120', 'ca': '0.08992805', 'sa': '0.08992805', 'pa': '0.08992805', 'co': 1},
    {'ra': '11122.49', 'ca': '0.02000000', 'sa': '0.02000000', 'pa': '0.02000000', 'co': 1},
    {'ra': '11122.5', 'ca': '0.28250000', 'sa': '0.28250000', 'pa': '0.28250000', 'co': 1},
    {'ra': '11122.52', 'ca': '0.46089150', 'sa': '0.46089150', 'pa': '0.46089150', 'co': 1},
    {'ra': '11122.53', 'ca': '1.59033594', 'sa': '1.59033594', 'pa': '1.59033594', 'co': 1},
    {'ra': '11180.00', 'ca': '0.01536315', 'sa': '0.01536315', 'pa': '0.01536315', 'co': 1}],
                                                                 'timestamp': '1642792869447', 'seqNo': '103810273'},
           {'status': 'Ok',
            'sell': [{'ra': '285.84', 'ca': '22.1898381', 'sa': '22.1898381', 'pa': '22.1898381', 'co': 1},
                     {'ra': '285.85', 'ca': '83.2', 'sa': '83.2', 'pa': '83.2', 'co': 1},
                     {'ra': '286.2', 'ca': '98.0', 'sa': '98.0', 'pa': '98.0', 'co': 1},
                     {'ra': '286.92', 'ca': '35.4600', 'sa': '35.4600', 'pa': '35.4600', 'co': 1},
                     {'ra': '286.93', 'ca': '842.6', 'sa': '842.6', 'pa': '842.6', 'co': 1},
                     {'ra': '286.96', 'ca': '165.09893423', 'sa': '165.09893423', 'pa': '165.09893423', 'co': 1},
                     {'ra': '287.34', 'ca': '50.0', 'sa': '50.0', 'pa': '50.0', 'co': 1},
                     {'ra': '287.71', 'ca': '18.47846337', 'sa': '18.47846337', 'pa': '18.47846337', 'co': 1},
                     {'ra': '288.24', 'ca': '160.0000', 'sa': '160.0000', 'pa': '160.0000', 'co': 1},
                     {'ra': '288.25', 'ca': '416.3', 'sa': '416.3', 'pa': '416.3', 'co': 1}],
            'buy': [{'ra': '281', 'ca': '2.39857651', 'sa': '2.39857651', 'pa': '2.39857651', 'co': 1},
                    {'ra': '282', 'ca': '42.57092199', 'sa': '42.57092199', 'pa': '42.57092199', 'co': 2},
                    {'ra': '282.26', 'ca': '834.7', 'sa': '834.7', 'pa': '834.7', 'co': 1},
                    {'ra': '282.52', 'ca': '83.2000000', 'sa': '83.2000000', 'pa': '83.2000000', 'co': 1},
                    {'ra': '282.53', 'ca': '0.39353765', 'sa': '0.39353765', 'pa': '0.39353765', 'co': 1},
                    {'ra': '283', 'ca': '2.00000000', 'sa': '2.00000000', 'pa': '2.00000000', 'co': 1},
                    {'ra': '283.05', 'ca': '50.0', 'sa': '50.0', 'pa': '50.0', 'co': 1},
                    {'ra': '283.06', 'ca': '546.28664401', 'sa': '546.28664401', 'pa': '546.28664401', 'co': 1},
                    {'ra': '283.5', 'ca': '98.0', 'sa': '98.0', 'pa': '98.0', 'co': 1},
                    {'ra': '283.51', 'ca': '527.5448', 'sa': '527.5448', 'pa': '527.5448', 'co': 1}],
            'timestamp': '1642792869956', 'seqNo': '25278473'}, {'status': 'Ok', 'sell': [
        {'ra': '9.99', 'ca': '1982.7944', 'sa': '1982.7944', 'pa': '1982.7944', 'co': 1},
        {'ra': '10.00', 'ca': '659.0', 'sa': '659.0', 'pa': '659.0', 'co': 1},
        {'ra': '10.08', 'ca': '1844.49295276', 'sa': '1844.49295276', 'pa': '1844.49295276', 'co': 1},
        {'ra': '10.09', 'ca': '425.0', 'sa': '425.0', 'pa': '425.0', 'co': 1},
        {'ra': '10.1', 'ca': '6582.71188119', 'sa': '6584.00000000', 'pa': '6582.71188119', 'co': 2},
        {'ra': '10.20', 'ca': '317.60839349', 'sa': '317.60839349', 'pa': '317.60839349', 'co': 2},
        {'ra': '10.54', 'ca': '9.25234605', 'sa': '657.00000000', 'pa': '9.25234605', 'co': 1},
        {'ra': '10.55', 'ca': '940.73377250', 'sa': '940.73377250', 'pa': '940.73377250', 'co': 1},
        {'ra': '10.76', 'ca': '937.82119443', 'sa': '937.82119443', 'pa': '937.82119443', 'co': 1},
        {'ra': '10.77', 'ca': '937.82119443', 'sa': '937.82119443', 'pa': '937.82119443', 'co': 1}], 'buy': [
        {'ra': '9.58', 'ca': '1304.0', 'sa': '1304.0', 'pa': '1304.0', 'co': 1},
        {'ra': '9.6', 'ca': '208.85416667', 'sa': '208.85416667', 'pa': '208.85416667', 'co': 2},
        {'ra': '9.7', 'ca': '133.54432989', 'sa': '133.54432989', 'pa': '133.54432989', 'co': 2},
        {'ra': '9.75', 'ca': '3344.0', 'sa': '3344.0', 'pa': '3344.0', 'co': 1},
        {'ra': '9.80', 'ca': '6795.0', 'sa': '6795.0', 'pa': '6795.0', 'co': 1},
        {'ra': '9.81', 'ca': '659.0', 'sa': '659.0', 'pa': '659.0', 'co': 1},
        {'ra': '9.84', 'ca': '1454.00000000', 'sa': '1454.00000000', 'pa': '1454.00000000', 'co': 2},
        {'ra': '9.88', 'ca': '2008.63377251', 'sa': '2008.63377251', 'pa': '2008.63377251', 'co': 2},
        {'ra': '9.89', 'ca': '24.5799259', 'sa': '24.5799259', 'pa': '24.5799259', 'co': 1},
        {'ra': '9.90', 'ca': '17.50469929', 'sa': '17.50469929', 'pa': '17.50469929', 'co': 1}],
                                                                 'timestamp': '1642792869973', 'seqNo': '8242354'}]
responses = [
    {'status': 'Ok', 'sell': [
        {'ra': '153800', 'ca': '0.39870045', 'sa': '0.4', 'pa': '0.39870045', 'co': 1},
        {'ra': '153898', 'ca': '0.02300634', 'sa': '0.02300634', 'pa': '0.02300634', 'co': 1},
        {'ra': '154036.5', 'ca': '0.00006', 'sa': '0.00006', 'pa': '0.00006', 'co': 1},
        {'ra': '154262.30', 'ca': '0.02448858', 'sa': '0.02448858', 'pa': '0.02448858', 'co': 2},
        {'ra': '154262.31', 'ca': '0.7582', 'sa': '0.7582', 'pa': '0.7582', 'co': 1},
        {'ra': '154769.69', 'ca': '1.0246', 'sa': '1.0246', 'pa': '1.0246', 'co': 1},
        {'ra': '154769.71', 'ca': '0.21659', 'sa': '0.21659', 'pa': '0.21659', 'co': 1},
        {'ra': '154769.79', 'ca': '0.09370607', 'sa': '0.09370607', 'pa': '0.09370607', 'co': 1},
        {'ra': '154769.83', 'ca': '0.03961217', 'sa': '0.03961217', 'pa': '0.03961217', 'co': 1},
        {'ra': '154770.00', 'ca': '7.5134', 'sa': '7.5134', 'pa': '7.5134', 'co': 1}],
     'buy': [{'ra': '153150', 'ca': '0.00163239', 'sa': '0.00163239', 'pa': '0.00163239', 'co': 1},
             {'ra': '153150.01', 'ca': '0.01731707', 'sa': '0.01731707', 'pa': '0.01731707', 'co': 1},
             {'ra': '153200', 'ca': '0.00652748', 'sa': '0.00652748', 'pa': '0.00652748', 'co': 1},
             {'ra': '153200.11', 'ca': '0.02218398', 'sa': '0.02610970', 'pa': '0.02218398', 'co': 1},
             {'ra': '153210', 'ca': '0.00231552', 'sa': '0.00231552', 'pa': '0.00231552', 'co': 2},
             {'ra': '153210.02', 'ca': '0.7582', 'sa': '0.7582', 'pa': '0.7582', 'co': 1},
             {'ra': '153421.58', 'ca': '0.00006', 'sa': '0.00006', 'pa': '0.00006', 'co': 1},
             {'ra': '153486', 'ca': '0.001', 'sa': '0.001', 'pa': '0.001', 'co': 1},
             {'ra': '153487.27', 'ca': '0.24700000', 'sa': '0.24700000', 'pa': '0.24700000', 'co': 1},
             {'ra': '153487.28', 'ca': '0.04278932', 'sa': '0.04278932', 'pa': '0.04278932', 'co': 1}],
     'timestamp': '1642794477572', 'seqNo': '91855942'}, {'status': 'Ok', 'sell': [
        {'ra': '11186.93', 'ca': '0.94890008', 'sa': '0.94890008', 'pa': '0.94890008', 'co': 1},
        {'ra': '11186.94', 'ca': '0.34341782', 'sa': '0.34341782', 'pa': '0.34341782', 'co': 1},
        {'ra': '11187.01', 'ca': '0.13000000', 'sa': '0.13000000', 'pa': '0.13000000', 'co': 1},
        {'ra': '11187.39', 'ca': '0.47000000', 'sa': '0.47000000', 'pa': '0.47000000', 'co': 1},
        {'ra': '11190', 'ca': '0.25671952', 'sa': '0.25671952', 'pa': '0.25671952', 'co': 1},
        {'ra': '11195.08', 'ca': '0.19950700', 'sa': '0.21379898', 'pa': '0.19950700', 'co': 1},
        {'ra': '11198.89', 'ca': '0.26063037', 'sa': '0.3000', 'pa': '0.26063037', 'co': 2},
        {'ra': '11200', 'ca': '1.01651142', 'sa': '1.07200695', 'pa': '1.01651142', 'co': 2},
        {'ra': '11216.11', 'ca': '13.23749', 'sa': '13.23749', 'pa': '13.23749', 'co': 2},
        {'ra': '11216.12', 'ca': '4.28', 'sa': '4.28', 'pa': '4.28', 'co': 1}], 'buy': [
        {'ra': '11070.01', 'ca': '6.91938431', 'sa': '6.91938431', 'pa': '6.91938431', 'co': 1},
        {'ra': '11080', 'ca': '0.05665415', 'sa': '0.05665415', 'pa': '0.05665415', 'co': 3},
        {'ra': '11100', 'ca': '1.10499634', 'sa': '2.24562431', 'pa': '1.10499634', 'co': 6},
        {'ra': '11100.1', 'ca': '0.00450446', 'sa': '0.00450446', 'pa': '0.00450446', 'co': 1},
        {'ra': '11110', 'ca': '0.01800180', 'sa': '0.01800180', 'pa': '0.01800180', 'co': 1},
        {'ra': '11111.5', 'ca': '0.06299779', 'sa': '0.06299779', 'pa': '0.06299779', 'co': 1},
        {'ra': '11115', 'ca': '0.00197931', 'sa': '0.00197931', 'pa': '0.00197931', 'co': 1},
        {'ra': '11117.50', 'ca': '0.03598021', 'sa': '0.03598021', 'pa': '0.03598021', 'co': 1},
        {'ra': '11120.37', 'ca': '0.4567357', 'sa': '0.4567357', 'pa': '0.4567357', 'co': 1},
        {'ra': '11120.4', 'ca': '1.55807879', 'sa': '1.55807879', 'pa': '1.55807879', 'co': 1}],
                                                          'timestamp': '1642794477631', 'seqNo': '103813188'},
    {'status': 'Ok', 'sell': [{'ra': '284.37', 'ca': '21.53968164', 'sa': '21.53968164', 'pa': '21.53968164', 'co': 1},
                              {'ra': '284.38', 'ca': '83.2', 'sa': '83.2', 'pa': '83.2', 'co': 1},
                              {'ra': '284.6', 'ca': '98.0', 'sa': '98.0', 'pa': '98.0', 'co': 1},
                              {'ra': '285.3', 'ca': '227.67557892', 'sa': '227.67557892', 'pa': '227.67557892',
                               'co': 1},
                              {'ra': '285.32', 'ca': '35.46000000', 'sa': '35.46000000', 'pa': '35.46000000', 'co': 1},
                              {'ra': '285.61', 'ca': '50.0', 'sa': '50.0', 'pa': '50.0', 'co': 1},
                              {'ra': '285.71', 'ca': '18.47846337', 'sa': '18.47846337', 'pa': '18.47846337', 'co': 1},
                              {'ra': '286.03', 'ca': '842.6', 'sa': '842.6', 'pa': '842.6', 'co': 1},
                              {'ra': '287.74', 'ca': '160.0000', 'sa': '160.0000', 'pa': '160.0000', 'co': 1},
                              {'ra': '288.13', 'ca': '416.3', 'sa': '416.3', 'pa': '416.3', 'co': 1}],
     'buy': [{'ra': '280.44', 'ca': '1.78291257', 'sa': '1.78291257', 'pa': '1.78291257', 'co': 1},
             {'ra': '281', 'ca': '2.39857651', 'sa': '2.39857651', 'pa': '2.39857651', 'co': 1},
             {'ra': '281.2', 'ca': '98.00000000', 'sa': '98.00000000', 'pa': '98.00000000', 'co': 1},
             {'ra': '281.35', 'ca': '50.0', 'sa': '50.0', 'pa': '50.0', 'co': 1},
             {'ra': '281.36', 'ca': '530.55267857', 'sa': '530.55267857', 'pa': '530.55267857', 'co': 2},
             {'ra': '282', 'ca': '42.57092199', 'sa': '42.57092199', 'pa': '42.57092199', 'co': 2},
             {'ra': '282.55', 'ca': '10.01312646', 'sa': '10.5', 'pa': '10.01312646', 'co': 1},
             {'ra': '282.6', 'ca': '3.06698514', 'sa': '3.06698514', 'pa': '3.06698514', 'co': 1},
             {'ra': '283', 'ca': '45.67632509', 'sa': '45.67632509', 'pa': '45.67632509', 'co': 1},
             {'ra': '283.01', 'ca': '472.76059', 'sa': '472.76059', 'pa': '472.76059', 'co': 1}],
     'timestamp': '1642794477633', 'seqNo': '25280825'}, {'status': 'Ok', 'sell': [
        {'ra': '9.86', 'ca': '2.92238010', 'sa': '2.92238010', 'pa': '2.92238010', 'co': 1},
        {'ra': '9.87', 'ca': '670.0', 'sa': '670.0', 'pa': '670.0', 'co': 1},
        {'ra': '9.9', 'ca': '2024.6525', 'sa': '2024.6525', 'pa': '2024.6525', 'co': 1},
        {'ra': '9.93', 'ca': '145.00260417', 'sa': '145.00260417', 'pa': '145.00260417', 'co': 1},
        {'ra': '9.95', 'ca': '415.00000000', 'sa': '415.00000000', 'pa': '415.00000000', 'co': 1},
        {'ra': '9.96', 'ca': '8422.49295276', 'sa': '8422.49295276', 'pa': '8422.49295276', 'co': 2},
        {'ra': '10.1', 'ca': '3.71188119', 'sa': '5.00000000', 'pa': '3.71188119', 'co': 1},
        {'ra': '10.20', 'ca': '317.60839349', 'sa': '317.60839349', 'pa': '317.60839349', 'co': 2},
        {'ra': '10.54', 'ca': '9.25234605', 'sa': '657.00000000', 'pa': '9.25234605', 'co': 1},
        {'ra': '10.55', 'ca': '940.73377250', 'sa': '940.73377250', 'pa': '940.73377250', 'co': 1}], 'buy': [
        {'ra': '9.6', 'ca': '208.85416667', 'sa': '208.85416667', 'pa': '208.85416667', 'co': 2},
        {'ra': '9.65', 'ca': '200.0', 'sa': '200.0', 'pa': '200.0', 'co': 1},
        {'ra': '9.67', 'ca': '3344.0', 'sa': '3344.0', 'pa': '3344.0', 'co': 1},
        {'ra': '9.68', 'ca': '6585.0', 'sa': '6585.0', 'pa': '6585.0', 'co': 1},
        {'ra': '9.7', 'ca': '93.78041237', 'sa': '93.78041237', 'pa': '93.78041237', 'co': 2},
        {'ra': '9.71', 'ca': '670.0', 'sa': '670.0', 'pa': '670.0', 'co': 1},
        {'ra': '9.72', 'ca': '845.00000000', 'sa': '845.00000000', 'pa': '845.00000000', 'co': 1},
        {'ra': '9.76', 'ca': '612.0', 'sa': '612.0', 'pa': '612.0', 'co': 1},
        {'ra': '9.77', 'ca': '554.36829804', 'sa': '554.36829804', 'pa': '554.36829804', 'co': 2},
        {'ra': '9.79', 'ca': '1500.0', 'sa': '1500.0', 'pa': '1500.0', 'co': 1}], 'timestamp': '1642794477670',
                                                          'seqNo': '8244212'}]

# print(f"{str(responses[0]['sell'][0]['ra'])}")
#
#
#
# a = {'one': "sth",
#      "two": "more",
#      "three": "data"}
# #
# print([*a])
# #
# print(list(a.keys()).index("two"))
#
# print(list(range(0,4)))
#
#
# d = {'btcpln': "rading/orderbook-limited/['btcpln']}/10",
#      'ethpln': "'ethpln']}/10",
#      'lunapln': "unapln']}/10",
#      'ftmpln': "ftmpln']}/10"}
#
# print(list(d.keys())[0])

tr = {"action": "push",
      "topic": "trading/transactions/eth-pln",
      "message": {
          "transactions": [
              {"id": "be329f75-7b63-11ec-9be8-0242ac110009", "t": "1642842886461", "a": "1.12074687", "r": "9800.15",
               "ty": "Buy"}]},
      "timestamp": "1642842886461", "seqNo": 2109232}

# print(tr['topic'].split('/')[2].replace("-", ""))
# print(tr['message']['transactions'][0]['id'])
# print(tr['message']['transactions'][0]['r'])
# print(tr['message']['transactions'][0]['a'])
# print(tr['timestamp'])

# k = {'amt': 16.99318568,
#      'bid': 2852532,
#      'rat': 6.27,
#      'sid': 2665037,
#      'stream': 'market.trade.thb_gala',
#      'sym': 'THB_GALA',
#      'ts': 1642860084,
#      'txn': 'GALASELL0000876211'}
#
# print(k['txn'])
# print(k['rat'])
# print(k['amt'])
# print(k['ts']*1000)
#
# print(f"{k['stream'].split('_')[1]}thb_trades")
#
#
#

# kub = [{'error': 0, 'result':
#     [[95406344, 1643420970, 4578.8, 1248396.48, 0.00366775], [95406393, 1643395826, 120021.24, 1249898.95, 0.09602476], [95406296, 1643395778, 30912.98, 1249899, 0.02473239], [95406264, 1643395765, 141327.84, 1249999.87, 0.11306229], [95406112, 1643395641, 2076.62, 1250000, 0.0016613]]}, {'error': 0, 'result': [[101108385, 1643395826, 16471.42, 1247260.02, 0.01320609], [101108380, 1643395824, 575593.28, 1247260.01, 0.4614862], [101108382, 1643395826, 4995890.22, 1247064.33, 4.00612071], [101108227, 1643395772, 47190.18, 1247064.32, 0.03784103], [101107997, 1643395691, 3693.01, 1247000, 0.00296152]]}, {'error': 0, 'result': [[87926978, 1643395824, 95886.18, 83192.56, 1.15258122], [87926982, 1643395826, 170544.74, 83192.56, 2.04999999], [87926553, 1643395570, 9218.99, 83200, 0.11080528], [87926983, 1643395826, 79695.71, 83285.55, 0.95689732], [87926817, 1643395727, 12.49, 83285.61, 0.00015]]}, {'error': 0, 'result': [[94073669, 1643395825, 344742.99, 83073.01, 4.14987964], [94073662, 1643395821, 13761.54, 83073, 0.165656], [94073674, 1643395827, 41969.17, 83040.03, 0.505409], [94073643, 1643395811, 5030.59, 83040.02, 0.06058038], [94073672, 1643395826, 6660.73, 83004.52, 0.08024544]]}, {'error': 0, 'result': [[62055604, 1643420717, 8241.25, 4.73, 1742.33822798], [62055584, 1643395787, 212.85, 4.73, 45], [62055614, 1643395819, 3868097.12, 4.7398, 816088.68], [62055495, 1643395710, 12080.36, 4.74, 2548.59958898], [62055593, 1643395801, 167372.88, 4.74, 35310.73446327]]}, {'error': 0, 'result': [[68666930, 1643395826, 0.28, 4.721, 0.05994603], [68666711, 1643395714, 0.01, 4.7205, 0.0037764], [68666655, 1643395691, 0.05, 4.72, 0.01202939], [68666703, 1643395712, 0.01, 4.72, 0.00400498], [68666905, 1643395814, 11.33, 4.7147, 2.40316901]]}, {'error': 0, 'result': [[42781325, 1643395793, 46394.64, 75.71, 612.79414368], [42781357, 1643395814, 20441.69, 75.71, 270], [42781314, 1643395786, 103979.38, 75.73, 1373.02772887], [42781363, 1643395826, 2015.1, 75.77, 26.5949918], [42781364, 1643395826, 9322.88, 75.78, 123.02561126]]}, {'error': 0, 'result': [[51540325, 1643395704, 0.44, 75.57, 0.00587569], [51540730, 1643395825, 2.26, 75.52, 0.0299524], [51540720, 1643395820, 15.11, 75.51, 0.20019362], [51538157, 1643394970, 0.22, 75.5, 0.00303102], [51540129, 1643395609, 0.07, 75.5, 0.001]]}, {'error': 0, 'result': [[14548197, 1643395759, 98.15, 33.73, 2.91], [14548212, 1643395795, 25903.54, 33.74, 767.74], [14548222, 1643395826, 99249.58, 33.74, 2941.6], [14548127, 1643395591, 99.56, 33.75, 2.95], [14547837, 1643407478, 135334.72, 33.76, 4008.73]]}, {'error': 0, 'result': [[18131976, 1643420927, 9.88, 33.7, 0.3], [18131977, 1643395771, 0.87, 33.7, 0.03], [18131928, 1643419715, 3.09, 33.68, 0.1], [18128549, 1643305732, 19.26, 33.66, 0.58], [18072964, 1643301946, 0, 33.66, 0.01]]}, {'error': 0, 'result': [[55501548, 1643395824, 13373.66, 34.96, 382.54198778], [55501553, 1643395825, 4839.03, 34.96, 138.41621156], [55501554, 1643395825, 139560.32, 34.96, 3992], [55501531, 1643395810, 1080932.31, 34.97, 30910.275], [55500712, 1643395128, 48608.2, 34.98, 1389.6]]}, {'error': 0, 'result': [[68654558, 1643395817, 0.17, 34.89, 0.00500146], [68654567, 1643395825, 1.22, 34.86, 0.0351347], [68654435, 1643420685, 3.47, 34.85, 0.099849], [68654259, 1643395561, 1.74, 34.85, 0.05], [68654040, 1643420320, 0.01, 34.82, 0.00030238]]}, {'error': 0, 'result': [[15307246, 1643395824, 278928, 116.22, 2400], [15307255, 1643395827, 10883.99, 116.28, 93.60159662], [15307256, 1643395827, 36101.49, 116.28, 310.47037666], [15307226, 1643395815, 112.71, 116.29, 0.96925581], [15307239, 1643395821, 6095.01, 116.32, 52.39867589]]}, {'error': 0, 'result': [[17603089, 1643395822, 100.24, 115.94, 0.86464225], [17603095, 1643395824, 0.7, 115.85, 0.00607038], [17603096, 1643395825, 3.06, 115.85, 0.02642225], [17603100, 1643395827, 1.25, 115.85, 0.01084374], [17603027, 1643395793, 17.25, 115.84, 0.14893501]]}, {'error': 0, 'result': [[45785155, 1643395491, 451.66, 610.46, 0.73988033], [45785549, 1643395825, 28533.27, 611.16, 46.68708162], [45785550, 1643395826, 5845.31, 611.83, 9.55381572], [45785548, 1643395825, 25077.24, 611.94, 40.97990238], [45785544, 1643395818, 2025.82, 611.97, 3.3103298]]}, {'error': 0, 'result': [[58018868, 1643395818, 1921.59, 609.53, 3.15257821], [58018867, 1643395817, 1.22, 609.52, 0.00201771], [58018834, 1643395797, 79.37, 609.04, 0.130334], [58018880, 1643395826, 3.64, 609, 0.00598747], [58018874, 1643395823, 16.04, 608.02, 0.0263812]]}, {'error': 0, 'result': [[7109684, 1643395826, 16067.8, 139.72, 115], [7109674, 1643395817, 124755.12, 139.86, 892], [7109658, 1643395803, 14309.72, 139.88, 102.3], [7109659, 1643395808, 452313.04, 139.88, 3233.5791], [7103568, 1643389305, 8999.4, 140, 64.28148327]]}, {'error': 0, 'result': [[8354543, 1643421024, 0.48, 139.12, 0.00346603], [8354542, 1643395824, 24.37, 139.08, 0.17523704], [8354538, 1643395823, 16.68, 139.06, 0.119994], [8354534, 1643395820, 1.02, 139, 0.0073783], [8354544, 1643395826, 16.3, 138.59, 0.11766291]]}, {'error': 0, 'result': [[3203067, 1643420629, 19802.14, 6.31, 3138.21617155], [3203078, 1643395823, 4606.29, 6.31, 730], [3203079, 1643395824, 5469.94, 6.31, 866.87], [3203081, 1643395826, 30047.61, 6.31, 4761.90424722], [3203009, 1643395711, 10433.72, 6.32, 1650.90657705]]}, {'error': 0, 'result': [[3437009, 1643395787, 0.03, 6.29, 0.0060595], [3437023, 1643395810, 0.16, 6.29, 0.0263601], [3437026, 1643395815, 0.06, 6.29, 0.01034207], [3437030, 1643395817, 1.75, 6.29, 0.27901144], [3437032, 1643395824, 0.03, 6.29, 0.00574441]]}, {'error': 0, 'result': [[33031084, 1643395797, 162606.84, 780643.59, 0.20829844], [33031092, 1643395819, 290766.54, 781630.49, 0.372], [33031093, 1643395824, 2011.09, 781858.9, 0.00257221], [33031086, 1643395799, 1062570.86, 784764.3, 1.354], [33031045, 1643395742, 105189.95, 784999.7, 0.134]]}, {'error': 0, 'result': [[42276770, 1643395823, 1559.74, 778737.9, 0.00200291], [42276772, 1643395824, 23289.36, 777999.68, 0.02993493], [42276345, 1643395531, 7713.3, 777999.65, 0.00991428], [42276607, 1643395715, 29274.48, 777879.04, 0.03763373], [42276353, 1643395536, 388.93, 777879, 0.0005]]}, {'error': 0, 'result': [[57281969, 1643395827, 13062.81, 533.92, 24.46585925], [57281967, 1643395826, 4431.61, 533.93, 8.30000001], [57281649, 1643395555, 1042.45, 534.47, 1.95045168], [57281968, 1643395827, 38266.48, 534.7, 71.56627481], [57281963, 1643395824, 1507.5, 534.73, 2.8191918]]}, {'error': 0, 'result': [[70681780, 1643395819, 819.51, 532.07, 1.54023602], [70681801, 1643395827, 4.13, 531.25, 0.00777583], [70681602, 1643395733, 66.01, 531.24, 0.124257], [70681739, 1643395796, 0.18, 531, 0.0003562], [70681706, 1643395780, 24.67, 530.48, 0.04652309]]}, {'error': 0, 'result': [[827452, 1643395825, 25134.52, 91.55, 274.54423256], [827451, 1643395825, 3018.29, 91.57, 32.9615702], [827453, 1643395826, 15545.87, 91.58, 169.75188674], [827442, 1643395797, 136781.32, 91.86, 1489.0194], [827406, 1643395725, 84244.79, 91.87, 917]]}, {'error': 0, 'result': [[880382, 1643395818, 0.27, 91.2, 0.00300609], [880373, 1643395769, 1.19, 91.1, 0.01312887], [880359, 1643395715, 0.67, 91.09, 0.0073783], [880364, 1643395718, 0.67, 91.08, 0.0073783], [880367, 1643395722, 0.03, 91.07, 0.0003562]]}, {'error': 0, 'result': [[27603065, 1643420824, 28443.82, 352, 80.80631785], [27603053, 1643395814, 15432.57, 352, 43.84255027], [27602433, 1643395289, 9875.46, 352.97, 27.97821052], [27596567, 1643415352, 604.83, 353, 1.7134221], [27598540, 1643391878, 159722.38, 353, 452.47135641]]}, {'error': 0, 'result': [[34615173, 1643395816, 183.34, 351.99, 0.5208931], [34615195, 1643395827, 3.55, 351.99, 0.01010519], [34615187, 1643395823, 14.04, 351.53, 0.03994715], [34615191, 1643395825, 12.83, 351.53, 0.03650639], [34615178, 1643395820, 0.12, 351.51, 0.0003562]]}, {'error': 0, 'result': [[20209083, 1643420636, 452.62, 96, 4.71483742], [20208982, 1643395599, 312.73, 96, 3.25767472], [20209114, 1643395755, 1938.41, 96, 20.19182795], [20209148, 1643395792, 2485.53, 96, 25.89101775], [20209161, 1643395823, 93504, 96, 974]]}, {'error': 0, 'result': [[23386254, 1643395827, 3.35, 95.81, 0.03496897], [23386252, 1643395826, 14.52, 95.79, 0.15165549], [23386255, 1643395827, 2.06, 95.73, 0.02153248], [23386213, 1643395795, 11.17, 95.72, 0.116747], [23386084, 1643395707, 0.8, 95.69, 0.00839201]]}, {'error': 0, 'result': [[33109509, 1643395824, 366.29, 351.86, 1.04101128], [33109515, 1643395826, 7002.01, 351.86, 19.9], [33109513, 1643395826, 21510.07, 351.87, 61.13074409], [33109514, 1643395826, 3521.12, 351.87, 10.00687844], [33109456, 1643395784, 169932.43, 352.1, 482.62548262]]}, {'error': 0, 'result': [[40394541, 1643395825, 1.16, 350.39, 0.0033261], [40394539, 1643395824, 10.37, 350.38, 0.02960702], [40394523, 1643395812, 63.93, 350.26, 0.18252616], [40394492, 1643395789, 42.82, 349.9, 0.122395], [40394535, 1643395821, 2.58, 349.81, 0.0073783]]}]
#
# print(len(kub))
#
# for i in range(len(kub)-1):
#     print(i)

w = [
    {'timestamp': 1643446182666,
     'asks':
         [['3025935.0', '0.00006'],
          ['3026983.0', '0.06375'],
          ['3026987.0', '0.00058'],
          ['3027449.0', '0.00063'],
          ['3027485.0', '0.00874'],
          ['3027537.0', '0.00011'],
          ['3028000.0', '0.00003'],
          ['3028634.0', '0.3'],
          ['3028635.0', '0.00273'],
          ['3028638.0', '0.0003']],
     'bids':
         [['3025635.0', '0.00063'],
          ['3022726.0', '5.21412'],
          ['3022725.0', '0.00198'],
          ['3022617.0', '0.04458'],
          ['3022616.0', '0.3'],
          ['3022574.0', '0.003'],
          ['3022272.0', '0.003'],
          ['3021965.0', '0.49573'],
          ['3021729.0', '0.00075'],
          ['3021492.0', '0.00031']]},
    {'timestamp': 1643446183673,
     'asks': [['204706.8', '0.0015'], ['204729.3', '0.0018'], ['204729.4', '0.1953'], ['204750.0', '0.2'],
              ['204754.3', '0.0004'], ['204759.0', '0.0602'], ['204889.9', '0.2741'], ['204890.0', '0.0004'],
              ['205005.1', '0.2443'], ['205268.4', '0.0977']],
     'bids': [['204500.4', '2.0'], ['204500.3', '0.152'], ['204500.2', '3.5932'], ['204500.0', '0.1236'],
              ['204455.4', '0.0034'], ['204316.5', '27.5742'], ['204316.0', '0.0006'], ['204181.6', '0.5421'],
              ['204000.0', '0.0332'], ['203943.0', '0.0024']]}, {'timestamp': 1643446184675,
                                                                 'asks': [['11.4704', '646.0'], ['11.471', '3601.0'],
                                                                          ['11.472', '30.0'], ['11.4725', '2998.0'],
                                                                          ['11.4797', '1317.0'], ['11.48', '3522.0'],
                                                                          ['11.4873', '25.0'], ['11.4874', '105.0'],
                                                                          ['11.4988', '8.0'], ['11.4998', '52.0']],
                                                                 'bids': [['11.47', '58.0'], ['11.4587', '1252.0'],
                                                                          ['11.4586', '3299.0'], ['11.4585', '43.0'],
                                                                          ['11.4511', '8509.0'], ['11.4435', '1048.0'],
                                                                          ['11.44', '534.0'], ['11.435', '81.0'],
                                                                          ['11.4315', '111.0'], ['11.4281', '1744.0']]},
    {'timestamp': 1643446185693,
     'asks': [['137.198', '411.4'], ['137.2', '145.7'], ['137.226', '11.0'], ['137.308', '7.4'], ['137.361', '116.6'],
              ['137.41', '0.6'], ['137.436', '1137.0'], ['137.463', '36.0'], ['137.496', '0.4'], ['137.499', '175.1']],
     'bids': [['137.026', '317.1'], ['137.0', '201.3'], ['136.995', '35.7'], ['136.994', '58.0'], ['136.992', '300.0'],
              ['136.942', '83.1'], ['136.85', '537.0'], ['136.816', '1137.0'], ['136.775', '41.5'],
              ['136.635', '5.8']]}, {'timestamp': 1643446186702,
                                     'asks': [['85.6995', '1916.2'], ['85.7339', '584.1'], ['85.75', '60.0'],
                                              ['85.7575', '23.4'], ['85.7578', '261.8'], ['85.7919', '50.0'],
                                              ['85.8', '1515.0'], ['85.8399', '49859.1'], ['85.8595', '2.0'],
                                              ['85.8598', '0.9']],
                                     'bids': [['85.5001', '237.4'], ['85.5', '291.1'], ['85.4564', '70.3'],
                                              ['85.4501', '3.0'], ['85.4401', '80168.3'], ['85.44', '35.1'],
                                              ['85.4367', '23.4'], ['85.43', '104.9'], ['85.4053', '637.0'],
                                              ['85.403', '21.4']]}, {'timestamp': 1643446187719,
                                                                     'asks': [['171.567', '13.2'], ['171.604', '34.9'],
                                                                              ['171.747', '161.3'], ['171.999', '21.3'],
                                                                              ['172.0', '102.3'], ['172.005', '16.8'],
                                                                              ['172.299', '139.9'], ['172.3', '292.3'],
                                                                              ['172.433', '1.0'], ['172.5', '36.6']],
                                                                     'bids': [['171.401', '126.0'], ['171.4', '799.9'],
                                                                              ['171.272', '83.6'], ['171.185', '0.7'],
                                                                              ['171.027', '17.6'], ['171.0', '2712.2'],
                                                                              ['170.867', '57.0'], ['170.5', '18.3'],
                                                                              ['170.305', '11.4'], ['170.005', '1.8']]},
    {'timestamp': 1643446188738,
     'asks': [['49.4798', '50.0'], ['49.48', '916.9'], ['49.5121', '1096.0'], ['49.52', '99.9'], ['49.55', '218.3'],
              ['49.5557', '1011.5'], ['49.5999', '485.5'], ['49.6', '2448.6'], ['49.6055', '533.9'],
              ['49.6144', '404.6']],
     'bids': [['49.3815', '53347.6'], ['49.3779', '150.4'], ['49.3749', '100.9'], ['49.3719', '40.4'],
              ['49.3702', '5.0'], ['49.3382', '166.6'], ['49.3', '40.5'], ['49.2946', '10.0'], ['49.2701', '197.8'],
              ['49.27', '60.9']]}, {'timestamp': 1643446189749,
                                    'asks': [['303.5', '7.0'], ['303.71231', '915.0'], ['303.91002', '803.0'],
                                             ['304.0', '15.0'], ['304.08139', '1000.0'], ['304.0814', '4.0'],
                                             ['304.13', '4.0'], ['304.42', '25.0'], ['304.5821', '5.0'],
                                             ['304.99979', '9.0']],
                                    'bids': [['303.49997', '2.0'], ['303.20616', '19.0'], ['303.18558', '19.0'],
                                             ['303.05645', '18.0'], ['303.0304', '2.0'], ['303.0001', '33.0'],
                                             ['303.0', '204.0'], ['302.56525', '11.0'], ['302.37928', '45.0'],
                                             ['302.14726', '250.0']]}, {'timestamp': 1643446190761,
                                                                        'asks': [['80.13', '89.0'],
                                                                                 ['80.19', '3572.41'],
                                                                                 ['80.2', '24.93'], ['80.21', '524.77'],
                                                                                 ['80.22', '4321.99'],
                                                                                 ['80.23', '3113.11'],
                                                                                 ['80.25', '345.71'],
                                                                                 ['80.27', '75.22'],
                                                                                 ['80.28', '32700.98'],
                                                                                 ['80.29', '4978.01']],
                                                                        'bids': [['80.12', '15446.26'],
                                                                                 ['80.11', '6075.42'],
                                                                                 ['80.1', '1069.53'],
                                                                                 ['80.09', '2185.46'],
                                                                                 ['80.08', '4826.56'],
                                                                                 ['80.07', '7539.94'],
                                                                                 ['80.06', '5669.45'],
                                                                                 ['80.05', '62299.81'],
                                                                                 ['80.04', '561.98'],
                                                                                 ['80.03', '75.82']]},
    {'timestamp': 1643446191770,
     'asks': [['7725.48', '1.571'], ['7725.57', '0.103'], ['7730.5', '10.0'], ['7730.51', '2.406'],
              ['7733.67', '6.023'], ['7740.03', '0.649'], ['7747.69', '0.968'], ['7748.85', '1.451'],
              ['7749.8', '0.968'], ['7750.0', '3.357']],
     'bids': [['7721.0', '12.305'], ['7720.0', '7.475'], ['7716.88', '0.776'], ['7715.03', '1.458'],
              ['7711.0', '0.976'], ['7710.99', '0.486'], ['7708.76', '0.829'], ['7700.0', '4.625'],
              ['7698.15', '4.136'], ['7684.25', '0.1']]}, {'timestamp': 1643446192763,
                                                           'asks': [['1498.65', '0.21'], ['1499.0', '16.0'],
                                                                    ['1499.3', '0.1'], ['1499.44', '5.0'],
                                                                    ['1499.5', '10.0'], ['1499.6', '10.0'],
                                                                    ['1499.7', '10.0'], ['1499.8', '10.0'],
                                                                    ['1499.88', '7.5'], ['1499.9', '20.0']],
                                                           'bids': [['1497.51', '0.67'], ['1492.82', '15.97'],
                                                                    ['1492.81', '16.17'], ['1492.8', '50.0'],
                                                                    ['1492.62', '0.88'], ['1492.0', '4.2'],
                                                                    ['1491.97', '5.85'], ['1491.26', '4.2'],
                                                                    ['1490.72', '75.9'], ['1490.0', '50.24']]},
    {'timestamp': 1643446193768,
     'asks': [['4294.6', '25.9'], ['4294.62', '1.4'], ['4295.0', '2.51'], ['4298.98', '37.5'], ['4298.99', '5.47'],
              ['4299.0', '3.02'], ['4299.25', '0.12'], ['4300.0', '75.31'], ['4300.16', '5.0'], ['4315.66', '1.18']],
     'bids': [['4289.3', '2.86'], ['4285.8', '0.06'], ['4284.95', '1.0'], ['4280.29', '4.0'], ['4280.0', '0.12'],
              ['4279.43', '37.5'], ['4279.42', '1.02'], ['4265.01', '50.0'], ['4265.0', '5.08'], ['4250.85', '5.59']]},
    {'timestamp': 1643446194818,
     'asks': [['4.6862', '11.0'], ['4.6866', '11.0'], ['4.687', '11.0'], ['4.6874', '11.0'], ['4.6878', '11.0'],
              ['4.6882', '11.0'], ['4.6886', '11.0'], ['4.689', '11.0'], ['4.6892', '56332.0'], ['4.6893', '2561.0']],
     'bids': [['4.685', '43674.0'], ['4.6827', '26.0'], ['4.6826', '1033.0'], ['4.6811', '2448.0'], ['4.6801', '181.0'],
              ['4.68', '1826.0'], ['4.6799', '1068.0'], ['4.6797', '200.0'], ['4.6796', '869.0'],
              ['4.675', '19427.0']]}, {'timestamp': 1643446195788,
                                       'asks': [['4.38', '2250.0'], ['4.38584', '664.0'], ['4.38641', '2222.0'],
                                                ['4.38696', '4568.0'], ['4.38731', '18093.0'], ['4.38787', '747.0'],
                                                ['4.38842', '50.0'], ['4.38999', '14.0'], ['4.39', '113.0'],
                                                ['4.39352', '11420.0']],
                                       'bids': [['4.376', '794.0'], ['4.36699', '14065.0'], ['4.36698', '15000.0'],
                                                ['4.36697', '687.0'], ['4.36404', '2234.0'], ['4.36171', '18093.0'],
                                                ['4.36', '1080.0'], ['4.35', '15000.0'], ['4.34484', '70.0'],
                                                ['4.34122', '196.0']]}, {'timestamp': 1643446196852,
                                                                         'asks': [['53.77', '3.4'], ['53.8', '74.34'],
                                                                                  ['53.81', '74.33'],
                                                                                  ['53.85', '148.56'],
                                                                                  ['53.92', '74.18'], ['54.0', '1.4'],
                                                                                  ['55.0', '3.45'], ['55.01', '1.65'],
                                                                                  ['55.2958', '9.88'],
                                                                                  ['55.6393', '1.46']],
                                                                         'bids': [['53.12', '18.82'],
                                                                                  ['53.11', '18.82'], ['53.0', '18.91'],
                                                                                  ['52.2099', '0.5'], ['52.0', '1.0'],
                                                                                  ['51.7628', '1.2'], ['51.6', '1.93'],
                                                                                  ['51.5', '1.96'], ['51.4', '1.0'],
                                                                                  ['51.14', '1.18']]},
    {'timestamp': 1643446197823,
     'asks': [['2564.4', '0.0725'], ['2564.42', '1.4623'], ['2565.07', '1.4619'], ['2565.31', '1.4618'],
              ['2566.66', '0.0084'], ['2567.23', '1.4607'], ['2571.66', '0.1797'], ['2571.76', '0.008'],
              ['2580.9', '0.0013'], ['2586.0', '0.0058']],
     'bids': [['2550.0', '0.0047'], ['2547.57', '1.4719'], ['2547.25', '1.4721'], ['2545.49', '1.4731'],
              ['2544.97', '1.4734'], ['2535.21', '0.0609'], ['2535.0', '0.0448'], ['2515.0', '0.0607'],
              ['2501.0', '0.0011'], ['2500.0', '0.001']]}]

err = [{'timestamp': 1643446513402,
        'asks': [['3024718.0', '0.00016'], ['3027045.0', '0.04242'], ['3027046.0', '0.3'], ['3028229.0', '0.00943'],
                 ['3028635.0', '0.00273'], ['3028638.0', '0.0003'], ['3028641.0', '0.00006'], ['3028647.0', '0.00007'],
                 ['3028649.0', '0.00002'], ['3029294.0', '0.00005']],
        'bids': [['3024398.0', '0.08'], ['3024299.0', '0.07267'], ['3024298.0', '0.01057'], ['3023996.0', '0.00002'],
                 ['3023498.0', '0.37454'], ['3023497.0', '0.05402'], ['3022574.0', '0.003'], ['3022272.0', '0.003'],
                 ['3021729.0', '0.00075'], ['3021492.0', '0.00031']]}, {'timestamp': 1643446513389,
                                                                        'asks': [['204703.3', '0.0871'],
                                                                                 ['204706.8', '0.004'],
                                                                                 ['204728.3', '0.3654'],
                                                                                 ['204729.3', '0.0018'],
                                                                                 ['204729.4', '0.1953'],
                                                                                 ['204754.3', '0.0004'],
                                                                                 ['204759.0', '0.0602'],
                                                                                 ['204794.2', '0.0977'],
                                                                                 ['204853.7', '0.3068'],
                                                                                 ['204890.0', '0.0004']],
                                                                        'bids': [['204650.8', '0.0265'],
                                                                                 ['204566.2', '0.2342'],
                                                                                 ['204566.1', '0.1282'],
                                                                                 ['204560.9', '0.0048'],
                                                                                 ['204500.2', '3.5932'],
                                                                                 ['204500.0', '0.1236'],
                                                                                 ['204455.4', '0.0034'],
                                                                                 ['204451.4', '0.0049'],
                                                                                 ['204316.0', '0.0006'],
                                                                                 ['204122.1', '0.3654']]},
       {'timestamp': 1643446513455,
        'asks': [['11.4579', '626.0'], ['11.458', '1232.0'], ['11.4586', '5.0'], ['11.4658', '14.0'],
                 ['11.4696', '22.0'], ['11.4697', '237.0'], ['11.47', '2447.0'], ['11.4725', '2998.0'],
                 ['11.48', '20.0'], ['11.4801', '1140.0']],
        'bids': [['11.451', '181.0'], ['11.4508', '215.0'], ['11.4436', '1413.0'], ['11.4435', '661.0'],
                 ['11.44', '534.0'], ['11.435', '81.0'], ['11.4315', '111.0'], ['11.4212', '2095.0'],
                 ['11.4211', '50000.0'], ['11.421', '72.0']]}, {'timestamp': 1643446513648,
                                                                'asks': [['136.679', '545.5'], ['136.752', '450.8'],
                                                                         ['136.763', '43.7'], ['136.775', '8.5'],
                                                                         ['136.8', '302.8'], ['136.835', '21.4'],
                                                                         ['136.84', '50.0'], ['136.85', '150.5'],
                                                                         ['136.897', '1.0'], ['136.933', '44.1']],
                                                                'bids': [['136.635', '5.8'], ['136.62', '0.7'],
                                                                         ['136.613', '72.1'], ['136.501', '235.1'],
                                                                         ['136.5', '303.0'], ['136.434', '11.2'],
                                                                         ['136.4', '100.0'], ['136.173', '1.0'],
                                                                         ['136.145', '14.0'], ['136.143', '22.1']]},
       {'code': 2136, 'message': 'Too many api request'}, {'timestamp': 1643446513815,
                                                           'asks': [['171.185', '260.1'], ['171.358', '6.6'],
                                                                    ['171.399', '157.5'], ['171.401', '2.0'],
                                                                    ['171.497', '1.0'], ['171.5', '29.2'],
                                                                    ['171.999', '140.2'], ['172.0', '102.3'],
                                                                    ['172.005', '16.8'], ['172.21', '64.7']],
                                                           'bids': [['171.105', '34.9'], ['171.001', '90.3'],
                                                                    ['171.0', '2712.2'], ['170.604', '2000.0'],
                                                                    ['170.6', '891.0'], ['170.5', '18.3'],
                                                                    ['170.305', '11.4'], ['170.171', '17.7'],
                                                                    ['170.004', '2.5'], ['170.003', '29.4']]},
       {'timestamp': 1643446513937,
        'asks': [['49.4583', '53.0'], ['49.4781', '243.1'], ['49.4794', '404.5'], ['49.4797', '793.8'],
                 ['49.4798', '39.9'], ['49.48', '901.0'], ['49.4964', '281.3'], ['49.52', '99.9'], ['49.55', '218.3'],
                 ['49.5999', '485.4']],
        'bids': [['49.425', '699.1'], ['49.3937', '129.1'], ['49.3779', '150.4'], ['49.3719', '40.4'],
                 ['49.3702', '5.0'], ['49.3386', '30822.9'], ['49.3382', '166.6'], ['49.3', '40.5'],
                 ['49.2946', '10.0'], ['49.2701', '197.8']]}, {'timestamp': 1643446514056,
                                                               'asks': [['303.0304', '31.0'], ['303.13163', '766.0'],
                                                                        ['303.13164', '27.0'], ['303.13169', '48.0'],
                                                                        ['303.5', '2.0'], ['303.6799', '3.0'],
                                                                        ['304.0', '28.0'], ['304.13', '4.0'],
                                                                        ['304.5821', '5.0'], ['304.99979', '9.0']],
                                                               'bids': [['303.0001', '33.0'], ['303.0', '69.0'],
                                                                        ['302.67557', '19.0'], ['302.56526', '30.0'],
                                                                        ['302.56525', '11.0'], ['302.14726', '250.0'],
                                                                        ['302.02251', '1.0'], ['302.0', '319.0'],
                                                                        ['301.0', '16.0'], ['300.1', '39.0']]},
       {'timestamp': 1643446514067,
        'asks': [['80.17', '680.53'], ['80.18', '3881.11'], ['80.19', '428.84'], ['80.2', '3422.39'],
                 ['80.21', '247.14'], ['80.22', '4321.99'], ['80.23', '3113.11'], ['80.25', '345.71'],
                 ['80.27', '75.22'], ['80.28', '3599.41']],
        'bids': [['80.16', '1438.14'], ['80.15', '12333.92'], ['80.14', '1675.07'], ['80.13', '1839.39'],
                 ['80.12', '287.08'], ['80.11', '9078.32'], ['80.1', '3211.35'], ['80.09', '1945.37'],
                 ['80.08', '4400.0'], ['80.07', '1300.44']]}, {'code': 2136, 'message': 'Too many api request'},
       {'timestamp': 1643446514296,
        'asks': [['1496.58', '5.54'], ['1497.15', '75.9'], ['1497.4', '12.52'], ['1498.5', '1.0'], ['1498.65', '0.21'],
                 ['1499.0', '16.0'], ['1499.3', '0.1'], ['1499.49', '33.43'], ['1499.5', '10.0'], ['1499.6', '10.0']],
        'bids': [['1494.44', '0.67'], ['1492.64', '50.0'], ['1492.63', '16.17'], ['1492.62', '0.88'],
                 ['1490.73', '16.06'], ['1490.72', '75.9'], ['1490.59', '10.06'], ['1490.0', '50.24'],
                 ['1486.0', '16.82'], ['1485.0', '24.53']]}, {'code': 2136, 'message': 'Too many api request'},
       {'timestamp': 1643446514497,
        'asks': [['4.6889', '1772.0'], ['4.6892', '41464.0'], ['4.6893', '2561.0'], ['4.6894', '12011.0'],
                 ['4.6896', '11.0'], ['4.6898', '11.0'], ['4.69', '625.0'], ['4.6902', '11.0'], ['4.6906', '11.0'],
                 ['4.691', '11.0']],
        'bids': [['4.6853', '330.0'], ['4.6828', '2179.0'], ['4.6827', '32.0'], ['4.6826', '533.0'],
                 ['4.6801', '181.0'], ['4.6799', '1068.0'], ['4.6797', '200.0'], ['4.6796', '33323.0'],
                 ['4.675', '19427.0'], ['4.6717', '24.0']]}, {'timestamp': 1643446514612,
                                                              'asks': [['4.37713', '18093.0'], ['4.37868', '748.0'],
                                                                       ['4.37885', '665.0'], ['4.37999', '11445.0'],
                                                                       ['4.38', '1206.0'], ['4.38081', '2225.0'],
                                                                       ['4.38446', '11445.0'], ['4.38842', '50.0'],
                                                                       ['4.38999', '14.0'], ['4.39', '113.0']],
                                                              'bids': [['4.36001', '29065.0'], ['4.36', '1080.0'],
                                                                       ['4.358', '689.0'], ['4.35687', '18093.0'],
                                                                       ['4.35663', '2237.0'], ['4.34484', '70.0'],
                                                                       ['4.34122', '196.0'], ['4.34', '2519.0'],
                                                                       ['4.33', '461.0'], ['4.32208', '351.0']]},
       {'timestamp': 1643446514718,
        'asks': [['53.59', '74.64'], ['53.62', '74.59'], ['53.6699', '0.31'], ['53.67', '74.52'], ['53.69', '74.5'],
                 ['53.77', '3.4'], ['53.8', '74.34'], ['54.0', '1.4'], ['55.0', '3.45'], ['55.01', '1.65']],
        'bids': [['53.0', '0.05'], ['52.89', '37.8'], ['52.8', '18.93'], ['52.2099', '0.5'], ['52.0', '1.0'],
                 ['51.7628', '1.2'], ['51.6', '1.93'], ['51.5', '1.96'], ['51.4', '1.0'], ['51.14', '1.18']]},
       {'code': 2136, 'message': 'Too many api request'}]

print(w[0]['timestamp'])  # timestamp

print(w[0]['asks'][0][0]) # first line ask
print(w[0]['asks'][0][1]) # first line ask_volume

print(w[0]['asks'][1][0]) # second line ask
print(w[0]['asks'][1][1]) # second line ask_volume

print(w[0]['bids'][0][0]) # first line bid
print(w[0]['bids'][0][1]) # first line bid_volume

print(w[0]['bids'][1][0]) # second line bid
print(w[0]['bids'][1][1]) # second line bid_volume

print(len(err))

for i in range(len(err)):
    try:
        if err[i]['code'] == 2136:
            print(err[i]['message'])
    except KeyError:
        continue
